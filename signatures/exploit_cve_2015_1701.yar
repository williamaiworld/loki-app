
rule CVE_2015_1701_Taihou {
	meta:
		description = "CVE-2015-1701 compiled exploit code - file Taihou32.exe / Taihou64.exe http://goo.gl/W4nU0q"
		author = "Florian Roth"
		reference = "http://goo.gl/W4nU0q"
		date = "2015-05-13"
		hash1 = "90d17ebd75ce7ff4f15b2df951572653efe2ea17"
		hash2 = "acf181d6c2c43356e92d4ee7592700fa01e30ffb"
	strings:
		$s1 = " Failed " fullword wide
		$s2 = "user32.dll" fullword wide
		$s3 = "%systemroot%\\system32\\" wide
		$s4 = "cmd.exe" wide
		$s5 = "PsLookupProcessByProcessId" fullword ascii 
		$s6 = "LoadLibraryExA" fullword ascii
		$s7 = "ntdll.dll" fullword ascii
	condition:
		uint16(0) == 0x5a4d and filesize < 30KB and all of them
}


